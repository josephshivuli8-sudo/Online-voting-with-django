{% extends "voting/base_auth.html" %}
{% load static %}
{% block title %}Login{% endblock %}

{% block content %}
<div class="auth-wrapper">

    <div class="auth-card glass-card animate-slide">

        <h2 class="text-center fw-bold mb-3">Welcome Back</h2>
        <p class="text-center text-muted mb-4">Log in to continue</p>

        <form method="POST" action="{% url 'account_login' %}" id="loginForm">
            {% csrf_token %}

            <!-- Email -->
            <div class="form-floating mb-3">
                <input type="email" class="form-control" name="email" id="emailInput" placeholder="Email" required>
                <label for="emailInput">Email</label>
            </div>

            <!-- Password -->
            <div class="form-floating mb-3 position-relative">
                <input type="password" class="form-control" name="password" id="passwordInput" placeholder="Password" required>
                <label for="passwordInput">Password</label>

                <!-- Show / Hide -->
                <span class="toggle-password" onclick="togglePass()">
                    <i class="fa fa-eye"></i>
                </span>

                <!-- Strength Meter -->
                <div id="strengthMeter" class="strength-meter mt-2"></div>
            </div>

            <button class="btn btn-primary w-100 py-2 mt-3">Log In</button>

            <p class="text-center mt-3">
                Donâ€™t have an account? <a href="{% url 'account_register' %}">Register</a>
            </p>

        </form>
    </div>
</div>

<style>
/* Glassmorphism */
.glass-card {
    background: rgba(255, 255, 255, 0.20);
    backdrop-filter: blur(12px);
    border-radius: 16px;
    padding: 35px;
    max-width: 420px;
    width: 100%;
    box-shadow: 0 8px 32px rgba(0,0,0,0.2);
}

/* Center Wrapper */
.auth-wrapper {
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

/* Floating label color adjustment */
.form-floating > label {
    color: #666;
}

.toggle-password {
    position: absolute;
    right: 15px;
    top: 18px;
    cursor: pointer;
    color: #6c757d;
}

.toggle-password:hover {
    color: #000;
}

/* Strength Meter */
.strength-meter {
    height: 5px;
    border-radius: 5px;
    background: #ddd;
}
.strength-meter.active-1 { background: red; }
.strength-meter.active-2 { background: orange; }
.strength-meter.active-3 { background: yellowgreen; }
.strength-meter.active-4 { background: green; }

/* Slide animation */
.animate-slide {
    animation: slideIn .6s ease-out;
}
@keyframes slideIn {
    from { transform: translateY(40px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

/* Shake effect */
.shake {
    animation: shakeEffect .3s;
}
@keyframes shakeEffect {
    0% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    50% { transform: translateX(5px); }
    75% { transform: translateX(-5px); }
    100% { transform: translateX(0); }
}
</style>

<script>
// Show/Hide Password
function togglePass() {
    const input = document.getElementById("passwordInput");
    input.type = input.type === "password" ? "text" : "password";
}

// Strength Meter
document.getElementById("passwordInput").addEventListener("input", function() {
    const strength = document.getElementById("strengthMeter");
    const val = this.value;
    let score = 0;

    if (val.length >= 6) score++;
    if (/[A-Z]/.test(val)) score++;
    if (/[0-9]/.test(val)) score++;
    if (/[@$!%*?&]/.test(val)) score++;

    strength.className = "strength-meter";

    if (score > 0) strength.classList.add("active-" + score);
});

// Shake on error
{% if messages %}
document.getElementById("loginForm").classList.add("shake");
{% endif %}
</script>

{% endblock %}
